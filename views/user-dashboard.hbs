<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{title}}</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>

<body>

    <!-- Navigation -->
    <header class="header">
        <nav class="nav">
            <a href="/" class="nav-brand">KickNHit</a>
            
            <div class="nav-links">
                <a href="#products" class="nav-link">üì¶ Products</a>
                <a href="#cart" class="nav-link">
                    üõí Cart
                    <span id="cart-count" class="cart-count">0</span>
                </a>
            </div>

            <div class="nav-user">
                <span class="nav-user-info">Welcome, <strong>{{user.firstName}}</strong></span>
                <form action="/logout" method="POST" style="display: inline;">
                    <button type="submit" class="btn btn-outline btn-sm">
                        Logout
                    </button>
                </form>
            </div>
        </nav>
    </header>

    <!-- Hero Section -->
    <section class="user-hero">
        <div class="user-hero-content">
            <!-- Text Content -->
            <div class="user-hero-text">
                <h1 class="user-hero-title">
                    Welcome to Your Sports Store,
                    <span class="user-hero-highlight">{{user.firstName}}!</span>
                </h1>
                <p class="user-hero-subtitle">
                    Discover premium cricket and football equipment with exclusive deals.
                </p>
                <p class="user-hero-description">
                    Simply click <span class="font-semibold">"Add to Cart"</span> on any item you like.<br>
                    Track your selections in the cart and checkout when ready!
                </p>
            </div>

            <!-- Image Crossfade Carousel for User Dashboard -->
            <div class="user-hero-image">
                <div class="hero-carousel">
                    <img id="img1"
                        src="https://media.istockphoto.com/id/520703373/photo/man-looking-to-buy-jacket-and-outdoor-equipment.jpg?s=612x612&w=0&k=20&c=foS1JrzI9m0M03GjRWSmMU_PqKcPCRjZRm3NQPcPMtA="
                        alt="Sports Equipment Store"
                        style="opacity: 1; z-index: 10;"
                    />
                    <img id="img2"
                        src=""
                        alt="Sports Equipment"
                        style="opacity: 0; z-index: 0;"
                    />
                </div>
            </div>
        </div>
    </section>    <script>
        // Hero carousel logic
        const images = [
            "https://media.istockphoto.com/id/520703373/photo/man-looking-to-buy-jacket-and-outdoor-equipment.jpg?s=612x612&w=0&k=20&c=foS1JrzI9m0M03GjRWSmMU_PqKcPCRjZRm3NQPcPMtA=",
            "https://imgstaticcontent.lbb.in/lbbnew/wp-content/uploads/sites/2/2016/06/SportShoppingCrownCricketerFeatured-i.jpg",
            "https://st.depositphotos.com/1480128/2099/i/950/depositphotos_20997099-stock-photo-kids-playing-football.jpg"
        ];

        let current = 0;
        const img1 = document.getElementById("img1");
        const img2 = document.getElementById("img2");

        setInterval(() => {
            const next = (current + 1) % images.length;

            if (img1.style.opacity === "1") {
                img2.src = images[next];
                img2.style.opacity = "1";
                img2.style.zIndex = "10";
                img1.style.opacity = "0";
                img1.style.zIndex = "0";
            } else {
                img1.src = images[next];
                img1.style.opacity = "1";
                img1.style.zIndex = "10";
                img2.style.opacity = "0";
                img2.style.zIndex = "0";
            }

            current = next;
        }, 2000);
    </script>


    <!-- Statistics Section -->
    <section class="stats">
        <div class="container">
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number">10K+</div>
                    <div class="stat-label">Happy Customers</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">500+</div>
                    <div class="stat-label">Products</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">50+</div>
                    <div class="stat-label">Brands</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">24/7</div>
                    <div class="stat-label">Support</div>
                </div>
            </div>
        </div>
    </section>


    <!-- Product Categories Section -->
    <section id="products" class="section">
        <div class="container">
            <div class="text-center mb-4">
                <h2 class="section-title">Shop by Category</h2>
                <p class="section-description">Find exactly what you need for your sport. Browse our extensive collection of professional-grade cricket and football equipment, designed for players at every level.</p>
            </div>

            <!-- Category Tabs -->
            <div class="category-tabs">
                <div class="category-tab-container">
                    <button onclick="showCategory('cricket')" id="cricket-tab" class="category-tab active">
                        üèè Cricket
                    </button>
                    <button onclick="showCategory('football')" id="football-tab" class="category-tab">
                        ‚öΩ Football
                    </button>
                </div>
            </div>

            <!-- Cricket Products -->
            <div id="cricket-products" class="product-category">
                <!-- Carousel view (when more than 3 products) -->
                <div id="cricket-carousel" class="hidden">
                    <div class="carousel-controls">
                        <h3 class="product-category-title">Cricket Products</h3>
                        <div class="carousel-nav">
                            <button onclick="scrollCarousel('cricket-carousel-items', -1)" class="carousel-btn">
                                ‚Üê
                            </button>
                            <button onclick="scrollCarousel('cricket-carousel-items', 1)" class="carousel-btn">
                                ‚Üí
                            </button>
                        </div>
                    </div>
                    <div class="product-carousel" id="cricket-carousel-items">
                        <!-- Products will appear here when in carousel mode -->
                    </div>
                </div>
                
                <!-- Grid view (when 3 or fewer products) -->
                <div id="cricket-grid" class="product-grid">
                    <!-- Products will be loaded dynamically from API -->
                </div>
            </div>

            <!-- Football Products -->
            <div id="football-products" class="product-category hidden">
                <!-- Carousel view (when more than 3 products) -->
                <div id="football-carousel" class="hidden">
                    <div class="carousel-controls">
                        <h3 class="product-category-title">Football Products</h3>
                        <div class="carousel-nav">
                            <button onclick="scrollCarousel('football-carousel-items', -1)" class="carousel-btn">
                                ‚Üê
                            </button>
                            <button onclick="scrollCarousel('football-carousel-items', 1)" class="carousel-btn">
                                ‚Üí
                            </button>
                        </div>
                    </div>
                    <div class="product-carousel" id="football-carousel-items">
                        <!-- Products will appear here when in carousel mode -->
                    </div>
                </div>
                
                <!-- Grid view (when 3 or fewer products) -->
                <div id="football-grid" class="product-grid">
                    <!-- Products will be loaded dynamically from API -->
                </div>
            </div>
        </div>
    </section>

    <!-- Featured Products Section -->
    <section id="featured" class="section">
        <div class="container">
            <div class="text-center mb-4">
                <p class="section-description">Hand-picked favorites loved by professionals</p>
            </div>

            <div class="product-grid">
                <!-- Featured Cricket Bat -->
                <div class="card featured-card">
                    <div class="card-img-container" style="position: relative;">
                        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTVi_V4PxSEsCrR_qmOF9MtDzxJnKpBI3-ikg&s"
                            alt="Professional Cricket Bat" class="card-img">
                        <div class="featured-badge">FEATURED</div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Professional Cricket Bat Pro</h3>
                        <p class="card-description">Premium English willow, used by international players</p>
                        <div class="card-footer">
                            <span class="card-price">‚Çπ4,999</span>
                            <button onclick="addToCart('featured-bat', 'Professional Cricket Bat Pro', 4999)" class="btn btn-primary btn-sm">
                                Add to Cart
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Featured Football Boots -->
                <div class="card featured-card">
                    <div class="card-img-container" style="position: relative;">
                        <img src="https://i.ebayimg.com/images/g/wqwAAOSwU0JjFook/s-l1200.webp"
                            alt="Professional Football Boots" class="card-img">
                        <div class="featured-badge">FEATURED</div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Elite Football Boots</h3>
                        <p class="card-description">Professional grade boots with advanced grip technology</p>
                        <div class="card-footer">
                            <span class="card-price">‚Çπ5,999</span>
                            <button onclick="addToCart('featured-boots', 'Elite Football Boots', 5999)" class="btn btn-primary btn-sm">
                                Add to Cart
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Featured Kit -->
                <div class="card featured-card">
                    <div class="card-img-container" style="position: relative;">
                        <img src="https://cdnmedia.dsc-cricket.com/media/catalog/product/cache/5b0ea239e50527b43e3253a7f103e237/d/s/dsc-2020-cricket-kit_2.webp"
                            alt="Complete Cricket Kit" class="card-img">
                        <div class="featured-badge">FEATURED</div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Complete Cricket Kit</h3>
                        <p class="card-description">Everything you need: bat, pads, gloves, helmet</p>
                        <div class="card-footer">
                            <span class="card-price">‚Çπ8,999</span>
                            <button onclick="addToCart('featured-kit', 'Complete Cricket Kit', 8999)" class="btn btn-primary btn-sm">
                                Add to Cart
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Sale Section -->
    <section id="sale" class="sale-section">
        <div class="container">
            <div class="text-center mb-4">
                <h2 class="section-title">Flash Sale - Limited Time!</h2>
                <p class="section-description">Up to 40% off on selected items</p>
            </div>

            <div class="flash-sale-grid">
                <!-- Sale Item 1 -->
                <div class="card sale-card">
                    <div class="card-img-container" style="position: relative;">
                        <img src="https://a2cricket.com/cdn/shop/files/A2Cricket-CricketBattingPads_7_1400x.jpg?v=1690984808"
                            alt="Cricket Pads" class="card-img">
                        <div class="sale-badge">40% OFF</div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Cricket Batting Pads</h3>
                        <div class="card-footer">
                            <div class="sale-price">
                                <span class="sale-price-main">‚Çπ1,199</span>
                                <span class="original-price">‚Çπ1,999</span>
                            </div>
                            <button onclick="addToCart('sale-pads', 'Cricket Batting Pads', 1199)" class="btn btn-danger btn-sm">
                                Add to Cart
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Sale Item 2 -->
                <div class="card sale-card">
                    <div class="card-img-container" style="position: relative;">
                        <img src="https://contents.mediadecathlon.com/p2571328/bcd3c25846279cde8d74b9996aef2566/p2571328.jpg?format=auto&quality=70&f=2520x0"
                            alt="Football" class="card-img">
                        <div class="sale-badge">35% OFF</div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Professional Football</h3>
                        <div class="card-footer">
                            <div class="sale-price">
                                <span class="sale-price-main">‚Çπ1,299</span>
                                <span class="original-price">‚Çπ1,999</span>
                            </div>
                            <button onclick="addToCart('sale-football', 'Professional Football', 1299)" class="btn btn-danger btn-sm">
                                Add to Cart
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Sale Item 3 -->
                <div class="card sale-card">
                    <div class="card-img-container" style="position: relative;">
                        <img src="https://sportsgoodsmarket.com/wp-content/uploads/2020/12/PRO-5-scaled.jpg"
                            alt="Cricket Gloves" class="card-img">
                        <div class="sale-badge">30% OFF</div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Cricket Batting Gloves</h3>
                        <div class="card-footer">
                            <div class="sale-price">
                                <span class="sale-price-main">‚Çπ629</span>
                                <span class="original-price">‚Çπ899</span>
                            </div>
                            <button onclick="addToCart('sale-gloves', 'Cricket Batting Gloves', 629)" class="btn btn-danger btn-sm">
                                Add to Cart
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Sale Item 4 -->
                <div class="card sale-card">
                    <div class="card-img-container" style="position: relative;">
                        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTFFjrb83_2blLq98U-oonOUB3NSU5JaX3-Dw&s"
                            alt="Cricket Helmet" class="card-img">
                        <div class="sale-badge">25% OFF</div>
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">Cricket Helmet</h3>
                        <div class="card-footer">
                            <div class="sale-price">
                                <span class="sale-price-main">‚Çπ974</span>
                                <span class="original-price">‚Çπ1,299</span>
                            </div>
                            <button onclick="addToCart('sale-helmet', 'Cricket Helmet', 974)" class="btn btn-danger btn-sm">
                                Add to Cart
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Cart Section -->
    <section id="cart" class="cart-section">
        <div class="cart-container">
            <div class="cart-grid">
                <!-- Cart Items -->
                <div class="cart-items">
                    <div id="cart-items">
                        <div class="empty-state">
                            <div class="empty-icon">üõí</div>
                            <p class="empty-message">Your cart is empty</p>
                            <p class="empty-submessage">Add some products to get started!</p>
                        </div>
                    </div>
                </div>

                <!-- Order Summary -->
                <div class="order-summary">
                    <h3 class="order-summary-title">Order Summary</h3>
                    <div class="order-summary-line">
                        <span>Subtotal:</span>
                        <span id="subtotal">‚Çπ0</span>
                    </div>
                    <div class="order-summary-line" style="color: #059669;">
                        <span>Shipping:</span>
                        <span>FREE</span>
                    </div>
                    <div class="order-summary-line order-summary-total">
                        <span>Total:</span>
                        <span id="total">‚Çπ0</span>
                    </div>
                    <button id="checkout-btn" onclick="checkout()" class="checkout-btn" disabled>
                        Proceed to Checkout
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Success Modal -->
    <div id="success-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-icon">üéâ</div>
            <h3 class="modal-title">Order Placed Successfully!</h3>
            <p class="modal-message">Thank you for shopping with KickNHit. Your order will be delivered soon!</p>
            <button onclick="closeModal()" class="btn btn-primary">
                Continue Shopping
            </button>
        </div>
    </div>


    <script>
        let cart = [];
        let allProducts = { cricket: [], football: [] };

        // Load products from API
        async function loadProducts() {
            try {
                const response = await fetch('/api/products');
                const data = await response.json();
                
                if (data.success) {
                    // Organize products by category
                    allProducts.cricket = data.products.filter(p => p.category === 'cricket');
                    allProducts.football = data.products.filter(p => p.category === 'football');
                    
                    // Display current category
                    const currentCategory = document.getElementById('cricket-products').classList.contains('hidden') ? 'football' : 'cricket';
                    displayProducts(currentCategory);
                } else {
                    console.error('Failed to load products:', data.message);
                }
            } catch (error) {
                console.error('Error loading products:', error);
            }
        }

        function displayProducts(category) {
            const products = allProducts[category];
            
            if (products.length === 0) {
                const container = document.getElementById(`${category}-grid`);
                container.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <div class="empty-icon">üì¶</div>
                        <p class="empty-message">No ${category} products available</p>
                        <p class="empty-submessage">Check back later for new arrivals!</p>
                    </div>
                `;
                return;
            }

            // Decide between grid and carousel view
            if (products.length <= 3) {
                showGridView(category, products);
            } else {
                showCarouselView(category, products);
            }
        }

        function showGridView(category, products) {
            const grid = document.getElementById(`${category}-grid`);
            const carousel = document.getElementById(`${category}-carousel`);
            
            // Show grid, hide carousel
            grid.classList.remove('hidden');
            carousel.classList.add('hidden');
            
            grid.innerHTML = products.map(product => createProductCardHTML(product, false)).join('');
        }

        function showCarouselView(category, products) {
            const grid = document.getElementById(`${category}-grid`);
            const carousel = document.getElementById(`${category}-carousel`);
            const carouselItems = document.getElementById(`${category}-carousel-items`);
            
            // Show carousel, hide grid
            carousel.classList.remove('hidden');
            grid.classList.add('hidden');
            
            carouselItems.innerHTML = products.map(product => createProductCardHTML(product, true)).join('');
        }

        function createProductCardHTML(product, isCarousel = false) {
            // Check if product is newly added (within last 24 hours)
            const isNew = product.createdAt && new Date(product.createdAt) > new Date(Date.now() - 24*60*60*1000);
            
            const cardClass = isCarousel ? 'card carousel-card' : 'card';
            const cardExtraClass = isNew ? ' product-card-new' : '';
            
            const newTag = isNew ? 
                `<div class="new-badge">NEW</div>` : '';

            return `
                <div class="${cardClass}${cardExtraClass}" data-product-id="${product._id}">
                    <div class="card-img-container" style="position: relative;">
                        <img src="${product.image}" 
                             alt="${product.name}" 
                             class="card-img"
                             onerror="this.src='https://via.placeholder.com/300x200?text=Image+Not+Found'">
                        ${newTag}
                    </div>
                    <div class="card-body">
                        <h3 class="card-title">${product.name}</h3>
                        <p class="card-description">${product.description}</p>
                        <div class="card-footer">
                            <span class="card-price">‚Çπ${product.price}</span>
                            <button onclick="addToCart('${product._id}', '${product.name}', ${product.price})" class="btn btn-primary btn-sm">
                                Add to Cart
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function scrollCarousel(carouselId, direction) {
            const carousel = document.getElementById(carouselId);
            const cardWidth = 280 + 24; // card width + gap
            const scrollAmount = cardWidth * direction;
            carousel.scrollBy({
                left: scrollAmount,
                behavior: 'smooth'
            });
        }

        function showCategory(category) {
            // Update tab styling
            const cricketTab = document.getElementById('cricket-tab');
            const footballTab = document.getElementById('football-tab');
            
            if (category === 'cricket') {
                cricketTab.classList.add('active');
                footballTab.classList.remove('active');
            } else {
                footballTab.classList.add('active');
                cricketTab.classList.remove('active');
            }

            // Show/hide product sections
            const cricketProducts = document.getElementById('cricket-products');
            const footballProducts = document.getElementById('football-products');
            
            if (category === 'cricket') {
                cricketProducts.classList.remove('hidden');
                footballProducts.classList.add('hidden');
            } else {
                footballProducts.classList.remove('hidden');
                cricketProducts.classList.add('hidden');
            }
            
            // Display products for the selected category
            displayProducts(category);
        }

        // Refresh products periodically to sync with admin changes
        function startProductSync() {
            setInterval(async () => {
                await loadProducts();
            }, 30000); // Refresh every 30 seconds
        }

        function addToCart(id, name, price) {
            const existingItem = cart.find(item => item.id === id);
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({ id, name, price, quantity: 1 });
            }
            updateCart();
            showNotification(`${name} added to cart!`);
        }

        function removeFromCart(id) {
            cart = cart.filter(item => item.id !== id);
            updateCart();
        }

        function updateQuantity(id, quantity) {
            const item = cart.find(item => item.id === id);
            if (item) {
                item.quantity = Math.max(1, quantity);
                updateCart();
            }
        }

        function updateCart() {
            const cartCount = document.getElementById('cart-count');
            const cartItems = document.getElementById('cart-items');
            const subtotal = document.getElementById('subtotal');
            const total = document.getElementById('total');
            const checkoutBtn = document.getElementById('checkout-btn');

            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCount.textContent = totalItems;

            if (cart.length === 0) {
                cartItems.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üõí</div>
                        <p class="empty-message">Your cart is empty</p>
                        <p class="empty-submessage">Add some products to get started!</p>
                    </div>
                `;
                checkoutBtn.disabled = true;
            } else {
                cartItems.innerHTML = `
                    <div class="text-center mb-3">
                        <div class="empty-icon">üõí</div>
                        <h3 class="card-title">View Your Cart</h3>
                        <p class="card-description">Review your selected items</p>
                    </div>
                    ${cart.map(item => `
                        <div class="cart-item">
                            <div class="cart-item-info">
                                <h4 class="cart-item-title">${item.name}</h4>
                                <p class="cart-item-price">‚Çπ${item.price}</p>
                            </div>
                            <div class="cart-item-controls">
                                <button onclick="updateQuantity('${item.id}', ${item.quantity - 1})" class="quantity-btn">-</button>
                                <span class="quantity-display">${item.quantity}</span>
                                <button onclick="updateQuantity('${item.id}', ${item.quantity + 1})" class="quantity-btn">+</button>
                                <button onclick="removeFromCart('${item.id}')" class="remove-btn">Remove</button>
                            </div>
                        </div>
                    `).join('')}
                `;
                checkoutBtn.disabled = false;
            }

            const subtotalAmount = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            subtotal.textContent = `‚Çπ${subtotalAmount}`;
            total.textContent = `‚Çπ${subtotalAmount}`;
        }

        function checkout() {
            if (cart.length === 0) return;

            document.getElementById('success-modal').classList.remove('hidden');
            document.getElementById('success-modal').classList.add('flex');
            cart = [];
            updateCart();
        }

        function closeModal() {
            document.getElementById('success-modal').classList.add('hidden');
            document.getElementById('success-modal').classList.remove('flex');
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification success';
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 300);
            }, 2000);
        }

        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });

        // Initialize page
        document.addEventListener('DOMContentLoaded', async function () {
            await loadProducts(); // Load products from API
            showCategory('cricket'); // Show cricket products by default
            startProductSync(); // Start periodic sync
        });
    </script>
</body>

</html>
